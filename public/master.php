<?php 
header("Set-Cookie: key=value; path=/; domain=example.org; HttpOnly;");

?>
<?php require_once("menue.php");?>
<!doctype html>
<html>
<head>
<title>
  Master page
</title>
<link rel="stylesheet" href="./stylesheets/public.css">
</head>
<body>

<div class ="topnav" >

<a href="http://localhost/p/public/master.php?page=home.php" class="fa fa-home"> </a>
<a href="http://localhost/p/public/master.php?page=login.php"> admin login</a>
      <a href="http://localhost/p/public/master.php?page=about.php" > About Us</a>
  <form action=" " method="get"> 
 <select name="page">
 <option value="login.php" > Admin login </option>
 <option value="about.php" > About us </option>
  <input type="submit"  value="submit" />
 </select>
 
 </form>

 </div>

<div id="main">

 <?php	  
 if(isset($_GET['admin'])){
 //RFI attack 
$str=($_GET['admin']);
$re = "/(?:file|ftps?|https?):\/\/(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|(?i:(\binclude\s*\([^)]*|mosConfig_absolute_path|_CONF\[path\]|_SERVER\[DOCUMENT_ROOT\]|GALLERY_BASEDIR|path\[docroot\]|appserv_root|config\[root_dir\])=(file|ftps?|https?):\/\/)|(?:file|ftps?|https?)(.*?)\?+|(?i)(?:file|ftps?|https?):\/\/(.*)/mi";
preg_match_all($re,$str,$matches , PREG_SET_ORDER , 0);
//var_dump($matches);
 if (empty($matches)) {
	 }
 else{
echo "this RFI   attack1";
}
$str= urlencode($str);
preg_match_all($re,$str,$matches , PREG_SET_ORDER , 0);
 if (empty($matches)) {
	 }
 else{
echo "this is RFI atack";
}
 
  
//command inection
$str=($_GET['admin']);// from input
$re = "/(;|\{|\||\|\||&|&&|\n|\r|`)\s*([\w'\"\.\/]+\/|[\\\\'\"\^]*\w[\\\\'\"\^]*:.*\\\\|[\^\.\w '\"\/\\\\]*\\\\)?[\(,@\'\"\s]*|[\"\^]|(m[\"\^]*(y[\"\^]*s[\"\^]*q[\"\^]*l([\"\^]*(d[\"\^]*u[\"\^]*m[\"\^]*p([\"\^]*s[\"\^]*l[\"\^]*o[\"\^]*w)?|h[\"\^]*o[\"\^]*t[\"\^]*c[\"\^]*o[\"\^]*p[\"\^]*y|a[\"\^]*d[\"\^]*m[\"\^]*i[\"\^]*n|s[\"\^]*h[\"\^]*o[\"\^]*w))?|s[\"\^]*(i[\"\^]*(n[\"\^]*f[\"\^]*o[\"\^]*3[\"\^]*2|e[\"\^]*x[\"\^]*e[\"\^]*c)|c[\"\^]*o[\"\^]*n[\"\^]*f[\"\^]*i[\"\^]*g|g[\"\^]*([\s,;]|\.|\/|<|>).*|t[\"\^]*s[\"\^]*c)|o[\"\^]*(u[\"\^]*n[\"\^]*t[\"\^]*(([\s,;]|\.|\/|<|>).*|v[\"\^]*o[\"\^]*l)|v[\"\^]*e[\"\^]*u[\"\^]*s[\"\^]*e[\"\^]*r|[dr][\"\^]*e[\"\^]*([\s,;]|\.|\/|<|>).*)|k[\"\^]*(d[\"\^]*i[\"\^]*r[\"\^]*([\s,;]|\.|\/|<|>).*|l[\"\^]*i[\"\^]*n[\"\^]*k)|d[\"\^]*(s[\"\^]*c[\"\^]*h[\"\^]*e[\"\^]*d|([\s,;]|\.|\/|<|>).*)|a[\"\^]*p[\"\^]*i[\"\^]*s[\"\^]*e[\"\^]*n[\"\^]*d|b[\"\^]*s[\"\^]*a[\"\^]*c[\"\^]*l[\"\^]*i|e[\"\^]*a[\"\^]*s[\"\^]*u[\"\^]*r[\"\^]*e|m[\"\^]*s[\"\^]*y[\"\^]*s)|d[\"\^]*(i[\"\^]*(s[\"\^]*k[\"\^]*((m[\"\^]*g[\"\^]*m|p[\"\^]*a[\"\^]*r)[\"\^]*t|s[\"\^]*h[\"\^]*a[\"\^]*d[\"\^]*o[\"\^]*w)|r[\"\^]*(([\s,;]|\.|\/|<|>).*|u[\"\^]*s[\"\^]*e)|f[\"\^]*f[\"\^]*([\s,;]|\.|\/|<|>).*)|e[\"\^]*(l[\"\^]*(p[\"\^]*r[\"\^]*o[\"\^]*f|t[\"\^]*r[\"\^]*e[\"\^]*e|([\s,;]|\.|\/|<|>).*)|v[\"\^]*(m[\"\^]*g[\"\^]*m[\"\^]*t|c[\"\^]*o[\"\^]*n)|(f[\"\^]*r[\"\^]*a|b[\"\^]*u)[\"\^]*g)|s[\"\^]*(a[\"\^]*(c[\"\^]*l[\"\^]*s|d[\"\^]*d)|q[\"\^]*u[\"\^]*e[\"\^]*r[\"\^]*y|m[\"\^]*o[\"\^]*(v[\"\^]*e|d)|g[\"\^]*e[\"\^]*t|r[\"\^]*m)|(r[\"\^]*i[\"\^]*v[\"\^]*e[\"\^]*r[\"\^]*q[\"\^]*u[\"\^]*e[\"\^]*r|o[\"\^]*s[\"\^]*k[\"\^]*e)[\"\^]*y|(c[\"\^]*o[\"\^]*m[\"\^]*c[\"\^]*n[\"\^]*f|x[\"\^]*d[\"\^]*i[\"\^]*a)[\"\^]*g|a[\"\^]*t[\"\^]*e[\"\^]*([\s,;]|\.|\/|<|>).*|n[\"\^]*s[\"\^]*s[\"\^]*t[\"\^]*a[\"\^]*t)|c[\"\^]*(o[\"\^]*(m[\"\^]*(p[\"\^]*((a[\"\^]*c[\"\^]*t[\"\^]*)?([\s,;]|\.|\/|<|>).*|m[\"\^]*g[\"\^]*m[\"\^]*t)|e[\"\^]*x[\"\^]*p)|n[\"\^]*(2[\"\^]*p|v[\"\^]*e)[\"\^]*r[\"\^]*t|p[\"\^]*y)|l[\"\^]*(e[\"\^]*a[\"\^]*(n[\"\^]*m[\"\^]*g[\"\^]*r|r[\"\^]*m[\"\^]*e[\"\^]*m)|u[\"\^]*s[\"\^]*t[\"\^]*e[\"\^]*r)|h[\"\^]*(k[\"\^]*(n[\"\^]*t[\"\^]*f[\"\^]*s|d[\"\^]*s[\"\^]*k)|d[\"\^]*i[\"\^]*r[\"\^]*([\s,;]|\.|\/|<|>).*)|s[\"\^]*(c[\"\^]*(r[\"\^]*i[\"\^]*p[\"\^]*t|c[\"\^]*m[\"\^]*d)|v[\"\^]*d[\"\^]*e)|e[\"\^]*r[\"\^]*t[\"\^]*(u[\"\^]*t[\"\^]*i[\"\^]*l|r[\"\^]*e[\"\^]*q)|a[\"\^]*(l[\"\^]*l[\"\^]*([\s,;]|\.|\/|<|>).*|c[\"\^]*l[\"\^]*s)|m[\"\^]*d([\"\^]*k[\"\^]*e[\"\^]*y)?|i[\"\^]*p[\"\^]*h[\"\^]*e[\"\^]*r|u[\"\^]*r[\"\^]*l)|f[\"\^]*(o[\"\^]*r[\"\^]*(m[\"\^]*a[\"\^]*t[\"\^]*([\s,;]|\.|\/|<|>).*|f[\"\^]*i[\"\^]*l[\"\^]*e[\"\^]*s|e[\"\^]*a[\"\^]*c[\"\^]*h)|i[\"\^]*n[\"\^]*d[\"\^]*(([\s,;]|\.|\/|<|>).*|s[\"\^]*t[\"\^]*r)|s[\"\^]*(m[\"\^]*g[\"\^]*m[\"\^]*t|u[\"\^]*t[\"\^]*i[\"\^]*l)|t[\"\^]*(p[\"\^]*([\s,;]|\.|\/|<|>).*|y[\"\^]*p[\"\^]*e)|r[\"\^]*e[\"\^]*e[\"\^]*d[\"\^]*i[\"\^]*s[\"\^]*k|c[\"\^]*([\s,;]|\.|\/|<|>).*|g[\"\^]*r[\"\^]*e[\"\^]*p)|n[\"\^]*(e[\"\^]*t[\"\^]*(s[\"\^]*(t[\"\^]*a[\"\^]*t|v[\"\^]*c|h)|([\s,;]|\.|\/|<|>).*|c[\"\^]*a[\"\^]*t|d[\"\^]*o[\"\^]*m)|t[\"\^]*(b[\"\^]*a[\"\^]*c[\"\^]*k[\"\^]*u[\"\^]*p|r[\"\^]*i[\"\^]*g[\"\^]*h[\"\^]*t[\"\^]*s)|(s[\"\^]*l[\"\^]*o[\"\^]*o[\"\^]*k[\"\^]*u|m[\"\^]*a)[\"\^]*p|c[\"\^]*(([\s,;]|\.|\/|<|>).*|a[\"\^]*t)|b[\"\^]*t[\"\^]*s[\"\^]*t[\"\^]*a[\"\^]*t)|e[\"\^]*(x[\"\^]*(p[\"\^]*(a[\"\^]*n[\"\^]*d[\"\^]*([\s,;]|\.|\/|<|>).*|l[\"\^]*o[\"\^]*r[\"\^]*e[\"\^]*r)|i[\"\^]*t)|v[\"\^]*e[\"\^]*n[\"\^]*t[\"\^]*(c[\"\^]*r[\"\^]*e[\"\^]*a[\"\^]*t[\"\^]*e|v[\"\^]*w[\"\^]*r)|n[\"\^]*d[\"\^]*l[\"\^]*o[\"\^]*c[\"\^]*a[\"\^]*l|g[\"\^]*r[\"\^]*e[\"\^]*p|r[\"\^]*a[\"\^]*s[\"\^]*e|c[\"\^]*h[\"\^]*o)|g[\"\^]*(a[\"\^]*t[\"\^]*h[\"\^]*e[\"\^]*r[\"\^]*n[\"\^]*e[\"\^]*t[\"\^]*w[\"\^]*o[\"\^]*r[\"\^]*k[\"\^]*i[\"\^]*n[\"\^]*f[\"\^]*o|p[\"\^]*((r[\"\^]*e[\"\^]*s[\"\^]*u[\"\^]*l|e[\"\^]*d[\"\^]*i)[\"\^]*t|u[\"\^]*p[\"\^]*d[\"\^]*a[\"\^]*t[\"\^]*e)|i[\"\^]*t[\"\^]*([\s,;]|\.|\/|<|>).*|e[\"\^]*t[\"\^]*m[\"\^]*a[\"\^]*c)|i[\"\^]*(r[\"\^]*b([\"\^]*(1([\"\^]*[89])?|2[\"\^]*[012]))?|f[\"\^]*m[\"\^]*e[\"\^]*m[\"\^]*b[\"\^]*e[\"\^]*r|p[\"\^]*c[\"\^]*o[\"\^]*n[\"\^]*f[\"\^]*i[\"\^]*g|n[\"\^]*e[\"\^]*t[\"\^]*c[\"\^]*p[\"\^]*l|c[\"\^]*a[\"\^]*c[\"\^]*l[\"\^]*s)|a[\"\^]*(d[\"\^]*(d[\"\^]*u[\"\^]*s[\"\^]*e[\"\^]*r[\"\^]*s|m[\"\^]*o[\"\^]*d[\"\^]*c[\"\^]*m[\"\^]*d)|r[\"\^]*p[\"\^]*([\s,;]|\.|\/|<|>).*|t[\"\^]*t[\"\^]*r[\"\^]*i[\"\^]*b|s[\"\^]*s[\"\^]*o[\"\^]*c|z[\"\^]*m[\"\^]*a[\"\^]*n)|l[\"\^]*(o[\"\^]*g[\"\^]*(e[\"\^]*v[\"\^]*e[\"\^]*n[\"\^]*t|t[\"\^]*i[\"\^]*m[\"\^]*e|m[\"\^]*a[\"\^]*n|o[\"\^]*f[\"\^]*f)|a[\"\^]*b[\"\^]*e[\"\^]*l[\"\^]*([\s,;]|\.|\/|<|>).*|u[\"\^]*s[\"\^]*r[\"\^]*m[\"\^]*g[\"\^]*r)|b[\"\^]*((c[\"\^]*d[\"\^]*(b[\"\^]*o[\"\^]*o|e[\"\^]*d[\"\^]*i)|r[\"\^]*o[\"\^]*w[\"\^]*s[\"\^]*t[\"\^]*a)[\"\^]*t|i[\"\^]*t[\"\^]*s[\"\^]*a[\"\^]*d[\"\^]*m[\"\^]*i[\"\^]*n|o[\"\^]*o[\"\^]*t[\"\^]*c[\"\^]*f[\"\^]*g)|h[\"\^]*(o[\"\^]*s[\"\^]*t[\"\^]*n[\"\^]*a[\"\^]*m[\"\^]*e|d[\"\^]*w[\"\^]*w[\"\^]*i[\"\^]*z)|j[\"\^]*a[\"\^]*v[\"\^]*a[\"\^]*([\s,;]|\.|\/|<|>).*|7[\"\^]*z([\"\^]*[ar])?)(\.[\"\^]*\w+)?\b|(;|\{|\||\|\||&|&&|\n|\r|`)\s*([\w'\"\.\/]+\/|[\\\\'\"\^]*\w[\\\\'\"\^]*:.*\\\\|[\^\.\w '\"\/\\\\]*\\\\)?[\(,@\'\"\s]*[\"\^]*(s[\"\^]*(y[\"\^]*s[\"\^]*(t[\"\^]*e[\"\^]*m[\"\^]*(p[\"\^]*r[\"\^]*o[\"\^]*p[\"\^]*e[\"\^]*r[\"\^]*t[\"\^]*i[\"\^]*e[\"\^]*s[\"\^]*(d[\"\^]*a[\"\^]*t[\"\^]*a[\"\^]*e[\"\^]*x[\"\^]*e[\"\^]*c[\"\^]*u[\"\^]*t[\"\^]*i[\"\^]*o[\"\^]*n[\"\^]*p[\"\^]*r[\"\^]*e[\"\^]*v[\"\^]*e[\"\^]*n[\"\^]*t[\"\^]*i[\"\^]*o[\"\^]*n|(p[\"\^]*e[\"\^]*r[\"\^]*f[\"\^]*o[\"\^]*r[\"\^]*m[\"\^]*a[\"\^]*n[\"\^]*c|h[\"\^]*a[\"\^]*r[\"\^]*d[\"\^]*w[\"\^]*a[\"\^]*r)[\"\^]*e|a[\"\^]*d[\"\^]*v[\"\^]*a[\"\^]*n[\"\^]*c[\"\^]*e[\"\^]*d)|i[\"\^]*n[\"\^]*f[\"\^]*o)|k[\"\^]*e[\"\^]*y|d[\"\^]*m)|h[\"\^]*(o[\"\^]*(w[\"\^]*(g[\"\^]*r[\"\^]*p|m[\"\^]*b[\"\^]*r)[\"\^]*s|r[\"\^]*t[\"\^]*c[\"\^]*u[\"\^]*t)|e[\"\^]*l[\"\^]*l[\"\^]*r[\"\^]*u[\"\^]*n[\"\^]*a[\"\^]*s|u[\"\^]*t[\"\^]*d[\"\^]*o[\"\^]*w[\"\^]*n|r[\"\^]*p[\"\^]*u[\"\^]*b[\"\^]*w|a[\"\^]*r[\"\^]*e|i[\"\^]*f[\"\^]*t)|e[\"\^]*(t[\"\^]*((x[\"\^]*)?([\s,;]|\.|\/|<|>).*|l[\"\^]*o[\"\^]*c[\"\^]*a[\"\^]*l)|c[\"\^]*p[\"\^]*o[\"\^]*l|l[\"\^]*e[\"\^]*c[\"\^]*t)|c[\"\^]*(h[\"\^]*t[\"\^]*a[\"\^]*s[\"\^]*k[\"\^]*s|l[\"\^]*i[\"\^]*s[\"\^]*t)|u[\"\^]*b[\"\^]*(i[\"\^]*n[\"\^]*a[\"\^]*c[\"\^]*l|s[\"\^]*t)|t[\"\^]*a[\"\^]*r[\"\^]*t[\"\^]*([\s,;]|\.|\/|<|>).*|i[\"\^]*g[\"\^]*v[\"\^]*e[\"\^]*r[\"\^]*i[\"\^]*f|l[\"\^]*(e[\"\^]*e[\"\^]*p|m[\"\^]*g[\"\^]*r)|o[\"\^]*r[\"\^]*t|f[\"\^]*c|v[\"\^]*n)|p[\"\^]*(s[\"\^]*(s[\"\^]*(h[\"\^]*u[\"\^]*t[\"\^]*d[\"\^]*o[\"\^]*w[\"\^]*n|e[\"\^]*r[\"\^]*v[\"\^]*i[\"\^]*c[\"\^]*e|u[\"\^]*s[\"\^]*p[\"\^]*e[\"\^]*n[\"\^]*d)|l[\"\^]*(o[\"\^]*g[\"\^]*(g[\"\^]*e[\"\^]*d[\"\^]*o[\"\^]*n|l[\"\^]*i[\"\^]*s[\"\^]*t)|i[\"\^]*s[\"\^]*t)|p[\"\^]*(a[\"\^]*s[\"\^]*s[\"\^]*w[\"\^]*d|i[\"\^]*n[\"\^]*g)|g[\"\^]*e[\"\^]*t[\"\^]*s[\"\^]*i[\"\^]*d|e[\"\^]*x[\"\^]*e[\"\^]*c|f[\"\^]*i[\"\^]*l[\"\^]*e|i[\"\^]*n[\"\^]*f[\"\^]*o|k[\"\^]*i[\"\^]*l[\"\^]*l)|o[\"\^]*(w[\"\^]*e[\"\^]*r[\"\^]*(s[\"\^]*h[\"\^]*e[\"\^]*l[\"\^]*l([\"\^]*_[\"\^]*i[\"\^]*s[\"\^]*e)?|c[\"\^]*f[\"\^]*g)|r[\"\^]*t[\"\^]*q[\"\^]*r[\"\^]*y|p[\"\^]*d)|r[\"\^]*(i[\"\^]*n[\"\^]*t[\"\^]*(([\s,;]|\.|\/|<|>).*|b[\"\^]*r[\"\^]*m)|n[\"\^]*(c[\"\^]*n[\"\^]*f[\"\^]*g|m[\"\^]*n[\"\^]*g[\"\^]*r)|o[\"\^]*m[\"\^]*p[\"\^]*t)|a[\"\^]*t[\"\^]*h[\"\^]*(p[\"\^]*i[\"\^]*n[\"\^]*g|([\s,;]|\.|\/|<|>).*)|e[\"\^]*r[\"\^]*(l([\"\^]*(s[\"\^]*h|5))?|f[\"\^]*m[\"\^]*o[\"\^]*n)|y[\"\^]*t[\"\^]*h[\"\^]*o[\"\^]*n([\"\^]*(3([\"\^]*m)?|2))?|k[\"\^]*g[\"\^]*m[\"\^]*g[\"\^]*r|h[\"\^]*p([\"\^]*[57])?|u[\"\^]*s[\"\^]*h[\"\^]*d|i[\"\^]*n[\"\^]*g)|r[\"\^]*(e[\"\^]*((p[\"\^]*l[\"\^]*a[\"\^]*c[\"\^]*e|n([\"\^]*a[\"\^]*m[\"\^]*e)?|s[\"\^]*e[\"\^]*t)[\"\^]*([\s,;]|\.|\/|<|>).*|g[\"\^]*(s[\"\^]*v[\"\^]*r[\"\^]*3[\"\^]*2|e[\"\^]*d[\"\^]*i[\"\^]*t|([\s,;]|\.|\/|<|>).*|i[\"\^]*n[\"\^]*i)|c[\"\^]*(d[\"\^]*i[\"\^]*s[\"\^]*c|o[\"\^]*v[\"\^]*e[\"\^]*r)|k[\"\^]*e[\"\^]*y[\"\^]*w[\"\^]*i[\"\^]*z)|u[\"\^]*(n[\"\^]*(d[\"\^]*l[\"\^]*l[\"\^]*3[\"\^]*2|a[\"\^]*s)|b[\"\^]*y[\"\^]*(1([\"\^]*[89])?|2[\"\^]*[012]))|a[\"\^]*(s[\"\^]*(p[\"\^]*h[\"\^]*o[\"\^]*n[\"\^]*e|d[\"\^]*i[\"\^]*a[\"\^]*l)|r[\"\^]*([\s,;]|\.|\/|<|>).*)|m[\"\^]*((d[\"\^]*i[\"\^]*r[\"\^]*)?([\s,;]|\.|\/|<|>).*|t[\"\^]*s[\"\^]*h[\"\^]*a[\"\^]*r[\"\^]*e)|o[\"\^]*(u[\"\^]*t[\"\^]*e[\"\^]*([\s,;]|\.|\/|<|>).*|b[\"\^]*o[\"\^]*c[\"\^]*o[\"\^]*p[\"\^]*y)|s[\"\^]*(t[\"\^]*r[\"\^]*u[\"\^]*i|y[\"\^]*n[\"\^]*c)|d[\"\^]*([\s,;]|\.|\/|<|>).*)|t[\"\^]*(a[\"\^]*(s[\"\^]*k[\"\^]*(k[\"\^]*i[\"\^]*l[\"\^]*l|l[\"\^]*i[\"\^]*s[\"\^]*t|s[\"\^]*c[\"\^]*h[\"\^]*d|m[\"\^]*g[\"\^]*r)|k[\"\^]*e[\"\^]*o[\"\^]*w[\"\^]*n)|(i[\"\^]*m[\"\^]*e[\"\^]*o[\"\^]*u|p[\"\^]*m[\"\^]*i[\"\^]*n[\"\^]*i|e[\"\^]*l[\"\^]*n[\"\^]*e|l[\"\^]*i[\"\^]*s)[\"\^]*t|s[\"\^]*(d[\"\^]*i[\"\^]*s[\"\^]*c[\"\^]*o|s[\"\^]*h[\"\^]*u[\"\^]*t[\"\^]*d)[\"\^]*n|y[\"\^]*p[\"\^]*e[\"\^]*(p[\"\^]*e[\"\^]*r[\"\^]*f|([\s,;]|\.|\/|<|>).*)|r[\"\^]*(a[\"\^]*c[\"\^]*e[\"\^]*r[\"\^]*t|e[\"\^]*e))|w[\"\^]*(i[\"\^]*n[\"\^]*(d[\"\^]*i[\"\^]*f[\"\^]*f|m[\"\^]*s[\"\^]*d[\"\^]*p|v[\"\^]*a[\"\^]*r|r[\"\^]*[ms])|u[\"\^]*(a[\"\^]*(u[\"\^]*c[\"\^]*l[\"\^]*t|p[\"\^]*p)|s[\"\^]*a)|s[\"\^]*c[\"\^]*(r[\"\^]*i[\"\^]*p[\"\^]*t|u[\"\^]*i)|e[\"\^]*v[\"\^]*t[\"\^]*u[\"\^]*t[\"\^]*i[\"\^]*l|m[\"\^]*i[\"\^]*(m[\"\^]*g[\"\^]*m[\"\^]*t|c)|a[\"\^]*i[\"\^]*t[\"\^]*f[\"\^]*o[\"\^]*r|h[\"\^]*o[\"\^]*a[\"\^]*m[\"\^]*i|g[\"\^]*e[\"\^]*t)|u[\"\^]*(s[\"\^]*(e[\"\^]*r[\"\^]*a[\"\^]*c[\"\^]*c[\"\^]*o[\"\^]*u[\"\^]*n[\"\^]*t[\"\^]*c[\"\^]*o[\"\^]*n[\"\^]*t[\"\^]*r[\"\^]*o[\"\^]*l[\"\^]*s[\"\^]*e[\"\^]*t[\"\^]*t[\"\^]*i[\"\^]*n[\"\^]*g[\"\^]*s|r[\"\^]*s[\"\^]*t[\"\^]*a[\"\^]*t)|n[\"\^]*(r[\"\^]*a[\"\^]*r|z[\"\^]*i[\"\^]*p))|q[\"\^]*(u[\"\^]*e[\"\^]*r[\"\^]*y[\"\^]*([\s,;]|\.|\/|<|>).*|p[\"\^]*r[\"\^]*o[\"\^]*c[\"\^]*e[\"\^]*s[\"\^]*s|w[\"\^]*i[\"\^]*n[\"\^]*s[\"\^]*t[\"\^]*a|g[\"\^]*r[\"\^]*e[\"\^]*p)|o[\"\^]*(d[\"\^]*b[\"\^]*c[\"\^]*(a[\"\^]*d[\"\^]*3[\"\^]*2|c[\"\^]*o[\"\^]*n[\"\^]*f)|p[\"\^]*e[\"\^]*n[\"\^]*f[\"\^]*i[\"\^]*l[\"\^]*e[\"\^]*s)|v[\"\^]*(o[\"\^]*l[\"\^]*([\s,;]|\.|\/|<|>).*|e[\"\^]*r[\"\^]*i[\"\^]*f[\"\^]*y)|x[\"\^]*c[\"\^]*(a[\"\^]*c[\"\^]*l[\"\^]*s|o[\"\^]*p[\"\^]*y)|z[\"\^]*i[\"\^]*p[\"\^]*([\s,;]|\.|\/|<|>).*)(\.[\"\^]*\w+)?\b|(if(\/i)?(not)?|(exist\b|defined\b|errorlevel\b|cmdextversion\b|( |\().*(?:\bgeq\b|\bequ\b|\bneq\b|\bleq\b|\bgtr\b|\blss\b|==))|((for \/[dflr].* *)|( %+[^ ]+ in)|\((.*\))\s?do))/mi";

preg_match_all($re,$str,$matches , PREG_SET_ORDER , 0);
//var_dump($matches);
 if (empty($matches)) {	
	 }
 else{
echo "this is an  command inection attack";
}
$str= urlencode($str);
preg_match_all($re,$str,$matches , PREG_SET_ORDER , 0);
 if (empty($matches)) {

	 }
 else{
echo "this is an command injection attack";
}

//LFI
 $reg =trim("/(?i)(?:\x5c|(?:%(?:c(?:0%(?:[2aq]f|5c|9v)|1%(?:[19p]c|8s|af))|2(?:5(?:c(?:0%25af|1%259c)|2f|5c)|%46|f)|(?:(?:f(?:8%8)?0%8|e)0%80%a|bg%q)f|%3(?:2(?:%(?:%6|4)6|F)|5%%63)|u(?:221[56]|002f|EFC8|F025)|1u|5c)|0x(?:2f|5c)|\/))(?:%(?:(?:f(?:(?:c%80|8)%8)?0%8|e)0%80%ae|2(?:(?:5(?:c0%25a|2))?e|%45)|u(?:(?:002|ff0)e|2024)|%32(?:%(?:%6|4)5|E)|c0(?:%[256aef]e|\.))|\.(?:%0[01]|\?)?|\?\.?|0x2e){2}(?:\x5c|(?:%(?:c(?:0%(?:[2aq]f|5c|9v)|1%(?:[19p]c|8s|af))|2(?:5(?:c(?:0%25af|1%259c)|2f|5c)|%46|f)|(?:(?:f(?:8%8)?0%8|e)0%80%a|bg%q)f|%3(?:2(?:%(?:%6|4)6|F)|5%%63)|u(?:221[56]|002f|EFC8|F025)|1u|5c)|0x(?:2f|5c)|\/))/");
foreach ($_REQUEST as $key => $value){
 preg_match_all($reg, $value, $match_array1);
 if (empty($match_array1)) {

 }else {
	 if(is_numeric($_GET['admin']) == TRUE){
		 include($_GET['page']);
		 exit;
	 }
		 
	 else {
	echo "lfi";
	exit;
 }
 }

 
//php payloads
//from logs.php
$regex= "/.*\.phtml\.*$|(\$[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*|\$\s*{.})|(\s*\.*\|\[.\]*\.*\|{.}*\(.*\)|\/\*.*\*\/*\(.*\)|\/\/.*\*\(.*\)|#.*\*\(.*\))";
$regex .="|(\$\+[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*)|(\$\+\s*{.\+})|(\s|\[.\+\]|{.\+}|\/\*.*\*\/|\/\/.*|#.*)*\||.*\\";
$regex .="|<\??!xml\s|<\?php|\\/|\\\\\|\?php\\\|(.*\.phtml\.*$)|php:\/\/stdin|php:\/\/stdout|php:\/\/stderr|php:\/\/input|php:\/\/output|php:\/\/fd|php:\/\/memory|php:\/\/temp|php:\/\/filter|\bset_exception_handler|\bset_error_handler|\bset_magic_quotes_runtime|\bset_include_path|\bsetdefaultstub|\bsession_set_save_handler|\bsession_start|\bsqlite_unbuffered_?query|\bsqlite_single_?query|\bsqlite_array_?query|\bsqlite_create_aggregate|\bsqlite_create_function|\bsqlite_p?open|\bsqlite_exec|\bstream_context_create|\bstream_socket_client|\bstripc?slashes|\bstrrev|\bsimplexml_load_string|\bsimplexml_load_file|\bsocket_connect|\bsocket_create|\bshow_source|\bsha1_file|\bspl_autoload_register|\bsystem|\bpreg_replace_callback_array??|\bpreg_match_all?|\bpreg_split|\bproc_terminate|\bproc_close|\bproc_nice|\bproc_get_status|\bproc_open|\bprint_r|\bposix_gete[gu]id|\bposix_getgid|\bposix_getlogin|\bposix_getpwnam|\bposix_mkfifo|\bposix_mknod|\bposix_ttyname|\bposix_kill|\bpopen|\bphp_strip_whitespace|\bphp_uname|\bphp_version|\bphp_info|\bpg_execute|\bpg_prepare|\bpg_connect|\bpg_query|\bparse_ini_file|\bparse_str|\bpassthru|\bputenv|\brunkit_function_redefine|\brunkit_function_rename|\brunkit_function_copy|\brunkit_function_add|\brunkit_method_redefine|\brunkit_method_rename|\brunkit_method_copy|\brunkit_method_add|\brunkit_constant_redefine|\brunkit_constant_add|\bregister_shutdown_function|\bregister_tick_function|\brename_function|\breadgz?file|\bread_exif_data|\breaddir|\brawurldecode|\brawurlencode|\bimagecreatefromjpeg|\bimagecreatefrompng|\bimagecreatefromx[bp]m|\bimagecreatefromwbmp|\bimagecreatefromgif|\bimagejpeg|\bimagepng|\bimagegd2|\bimagegif|\bimage2?wbmp|\bimagexbm|\bis_executable|\bis_executable|\bis_write?able|\bis_readable|\bis_file|\bis_dir|\bini_get_all?|\bini_set|\biterator_apply|\biptcembed|\bget_current_user|\bget_cfg_var|\bget_meta_tags|\bgetmy[gpu]id|\bgetmyinode|\bgetlastmod|\bgetcwd|\bgetimagesize|\bgetenv|\bgzdeflate|\bgzwrite|\bgzencode|\bgzfile|\bgzcompress|\bgzopen|\bgzread|\bglob|\barray_uintersect_u?assoc?|\barray_udiff_u?assoc?|\barray_intersect_uassoc|\barray_intersect_ukey|\barray_diff_uassoc|\barray_diff_ukey|\barray_filter|\barray_reduce|\barray_map|\bassert_options?|\bhtmlspecialchars_decode?|\bhtmlentities|\bhtml_entity_decode|\bhash_update?_file|\bhash_hmac?_file|\bhighlight_file|\bheader_register_callback|\bhex2bin|\bfile[acm]time?|\bfileinode?|\bfile_exists?|\bfileperms?|\bfilegroup?|\bfinfo_open|\bftp_nb_get|\bftp_nb_put|\bftp_connect|\bftp_get|\bftp_put|\bfunction_exists|\bfputs|\bfwrite|\bfopen|\bob_get_contents|\bob_get_clean|\bob_get_flush|\bob_end_clean|\bob_end_flush|\bob_clean|\bob_flush|\bob_start|\bodbc_result_all?|\bodbc_execute?|\bodbc_connect|\bopendir|\bmb_ereg_replace_callback??|\bmb_ereg_match?|\bmb_eregi_replace??|\bmb_parse_str|\bmove_uploaded_file|\bmd5_file|\bmethod_exists|\bmysql_query|\bmkdir|\bexif_thumbnail|\bexif_tagname|\bexif_imagetype|\bexif_read_data|\bexec|\bescapeshellarg|\bescapeshellcmd|\berror_reporting|\beval|\bcurl_file_create|\bcurl_exec|\bcurl_init|\bconvert_uuencode|\bcreate_function|\bchr|\bunserialize|\bunpack|\burldecode|\burlencode|\bu[ak]?sort|\bjson_decode|\bjson_encode|\bdebug_backtrace|\btmpfile|\bbson_decode|\bbson_encode|\bbase64_encode|\bbzopen|\bvar_dump|\s*\|\/\*.*\*\/*\|\/\/.*\*\|#.*\*\|.*\\\|([oOcC]:\d+:\".+?\":\d+:{.*})|(HTTP_ACCEPT_ENCODING?|HTTP_ACCEPT_LANGUAGE?|HTTP_ACCEPT_CHARSET?|HTTP_X_FORWARDED_FOR|HTTP_REFERER|HTTP_USER_AGENT|HTTP_HOST|HTTP_CONNECTION|HTTP_KEEP_ALIVE|PATH_TRANSLATED|PATH_INFO|ORIG_PATH_INFO|QUERY_STRING|REQUEST_URI|AUTH_TYPE)|(\bis_integer?|\bis_infinite|\bis_numeric|\bis_null|\bis_nan|\bis_callable|\bis_double|\bis_scalar|\bis_string|\bis_finite|\bis_float|\bis_resource|\bis_real|\bis_link|\bis_long|\bis_array?|\bis_object|\bis_bool|\bisset|\binclude|\binvoke|\bintdiv|\bintval|\bimplode|\bidate|\biconv|\bstrlen|\bstrspn|\bstrcoll|\bstat|\bserialize|\bsettype|\bshuffle|\bsimilar_text|\bsizeof|\bsinh?|\bspliti?|\bsprintf|\bscandir|\bsubstr|\bsymlink|\bsyslog|\bsoundex|\bsort|\bsleep|\bsrand|\bsqrt|\bfilesize|\bfiletype|\bfileowner|\bfilepro|\bfloatval|\bflock|\bfloor|\bflush|\bfread|\bfmod|\bftell|\bfok|\bfunction|\bfclose|\bfgets|\bfstat|\bfeof|\bchown|\bchop|\bcheckdate|\bchroot|\bchdir|\bchmod|\bconstant|\bcount|\bcompact|\bcosh?|\bcopy|\bclosedir|\bcloselog|\bcurrent|\bcrypt|\bceil|\bextract|\bexit|\bexplode?|\beaster_date|\beaster_days|\beach|\berror_log|\beregi?|\bempty|\becho|bend|\blog1[0p]?|\blocaltime|\blinkinfo?|\blist|\blcfirst|\blstat|\blevenshtein|\bltrim|\bdiskfreespac?e|\bdirname?|\bde|\bdeoubleva?l|\bdate|\brequire|\brecode|\brename|\breadlin[ek]|\brewind|\breset|\brange|\brand|\bround|\brsort|\brtrim|\bmbsplit|\bmbereg|\bmicrotime|\bmin|\bmai[ln]|\bmax|\bmetaphone|\bmy?sql|\bmhash|\buntaint|\bunset|\buniqid|\bunlink|\busleep|\busort|\bucfirst|\bumask|\bassert|\basort|\basinh?|\barsort|\barray|\batan[2h]?|\bacosh?|\babs|\btextdomain|\btempnam|\btaint|\btanh?|\btouch|\btime|\btrim|\bheaders_list?|\bheaders_sent?|\bhebrev|\bhypot|\bhash|\bpathinfo|\bpack|\bprintf?|\bprev|\bpclose|\bpo[sw]|\bpi|\bgettext|\bgettype|\bgetdate|\bgmdate|\bopenlog|\boctdec|\bord|\bbasename|\bbindec|\bnatsort|\bnext|\bksort|\bkey|\bquotemeta|\bwordwrap|\bvirtual|\bjoin|\s*\|\/\*.*\*\/*\|\/\/.*\*\|#.*\*\|.*\\\)|(.*\.php\d*\..*$|.*\.phtml\..*$)|\bphpinfo|\bprint|\bperl|\bdir/";
$str = $_GET['admin'];
 preg_match_all($regex, $str, $match_array, PREG_SET_ORDER, 0);
 if (empty($match_array)) {
 }else{
	echo "php attack";
	exit;
	
	  }
 
 
 }}
 
 if(isset($_GET['page'])){
 //RFI attack 
$str=($_GET['page']);
$re = "/(?:file|ftps?|https?):\/\/(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|(?i:(\binclude\s*\([^)]*|mosConfig_absolute_path|_CONF\[path\]|_SERVER\[DOCUMENT_ROOT\]|GALLERY_BASEDIR|path\[docroot\]|appserv_root|config\[root_dir\])=(file|ftps?|https?):\/\/)|(?:file|ftps?|https?)(.*?)\?+|(?i)(?:file|ftps?|https?):\/\/(.*)/mi";
preg_match_all($re,$str,$matches , PREG_SET_ORDER , 0);
//var_dump($matches);
 if (empty($matches)) {
	 }
 else{
echo "this RFI   attack";
exit;
}
$str= urlencode($str);
preg_match_all($re,$str,$matches , PREG_SET_ORDER , 0);
 if (empty($matches)) {
	 }
 else{
echo "this is RFI attack";
exit;
} 
//XSS
foreach ($_REQUEST as $key => $value){ /// it should be qet page 
 $re ="/((?i)([<＜]script[^>＞]*[>＞][\s\S]*?))|(?i)([\s\"\'`;\/0-9\=\x0B\x09\x0C\x3B\x2C\x28\x3B]+on[a-zA-Z]+[\s\x0B\x09\x0C\x3B\x2C\x28\x3B]*?=)|(?i)[\s\S](?:x(?:link:href|html|mlns)|!ENTITY.*?SYSTEM|data:text\/html|pattern(?=.*?=)|formaction|\@import|base64)\b|(?i)(?:<(?:(?:apple|objec)t|isindex|embed|style|form|meta)\b[^>]*?>[\s\S]*?|(?:=|U\s*?R\s*?L\s*?\()\s*?[^>]*?\s*?S\s*?C\s*?R\s*?I\s*?P\s*?T\s*?:)|(?i)<[^\w<>]*(?:[^<>\"'\s]*:)?[^\w<>]*(?:\W*?s\W*?c\W*?r\W*?i\W*?p\W*?t|\W*?f\W*?o\W*?r\W*?m|\W*?s\W*?t\W*?y\W*?l\W*?e|\W*?s\W*?v\W*?g|\W*?m\W*?a\W*?r\W*?q\W*?u\W*?e\W*?e|(?:\W*?l\W*?i\W*?n\W*?k|\W*?o\W*?b\W*?j\W*?e\W*?c\W*?t|\W*?e\W*?m\W*?b\W*?e\W*?d|\W*?a\W*?p\W*?p\W*?l\W*?e\W*?t|\W*?p\W*?a\W*?r\W*?a\W*?m|\W*?i?\W*?f\W*?r\W*?a\W*?m\W*?e|\W*?b\W*?a\W*?s\W*?e|\W*?b\W*?o\W*?d\W*?y|\W*?m\W*?e\W*?t\W*?a|\W*?i\W*?m\W*?a?\W*?g\W*?e?|\W*?v\W*?i\W*?d\W*?e\W*?o|\W*?a\W*?u\W*?d\W*?i\W*?o|\W*?b\W*?i\W*?n\W*?d\W*?i\W*?n\W*?g\W*?s|\W*?s\W*?e\W*?t|\W*?a\W*?n\W*?i\W*?m\W*?a\W*?t\W*?e)[^>\w])|(?:<\w[\s\S]*[\s\/]|['\"](?:[\s\S]*[\s\/])?)(?:formaction|style|background|src|lowsrc|ping|on(?:d(?:e(?:vice(?:(?:orienta|mo)tion|proximity|found|light)|livery(?:success|error)|activate)|r(?:ag(?:e(?:n(?:ter|d)|xit)|(?:gestur|leav)e|start|drop|over)?|op)|i(?:s(?:c(?:hargingtimechange|onnect(?:ing|ed))|abled)|aling)|ata(?:setc(?:omplete|hanged)|(?:availabl|chang)e|error)|urationchange|ownloading|blclick)|Moz(?:M(?:agnifyGesture(?:Update|Start)?|ouse(?:PixelScroll|Hittest))|S(?:wipeGesture(?:Update|Start|End)?|crolledAreaChanged)|(?:(?:Press)?TapGestur|BeforeResiz)e|EdgeUI(?:C(?:omplet|ancel)|Start)ed|RotateGesture(?:Update|Start)?|A(?:udioAvailable|fterPaint))|c(?:o(?:m(?:p(?:osition(?:update|start|end)|lete)|mand(?:update)?)|n(?:t(?:rolselect|extmenu)|nect(?:ing|ed))|py)|a(?:(?:llschang|ch)ed|nplay(?:through)?|rdstatechange)|h(?:(?:arging(?:time)?ch)?ange|ecking)|(?:fstate|ell)change|u(?:echange|t)|l(?:ick|ose))|m(?:o(?:z(?:pointerlock(?:change|error)|(?:orientation|time)change|fullscreen(?:change|error)|network(?:down|up)load)|use(?:(?:lea|mo)ve|o(?:ver|ut)|enter|wheel|down|up)|ve(?:start|end)?)|essage|ark)|s(?:t(?:a(?:t(?:uschanged|echange)|lled|rt)|k(?:sessione|comma)nd|op)|e(?:ek(?:complete|ing|ed)|(?:lec(?:tstar)?)?t|n(?:ding|t))|u(?:ccess|spend|bmit)|peech(?:start|end)|ound(?:start|end)|croll|how)|b(?:e(?:for(?:e(?:(?:scriptexecu|activa)te|u(?:nload|pdate)|p(?:aste|rint)|c(?:opy|ut)|editfocus)|deactivate)|gin(?:Event)?)|oun(?:dary|ce)|l(?:ocked|ur)|roadcast|usy)|a(?:n(?:imation(?:iteration|start|end)|tennastatechange)|fter(?:(?:scriptexecu|upda)te|print)|udio(?:process|start|end)|d(?:apteradded|dtrack)|ctivate|lerting|bort)|DOM(?:Node(?:Inserted(?:IntoDocument)?|Removed(?:FromDocument)?)|(?:CharacterData|Subtree)Modified|A(?:ttrModified|ctivate)|Focus(?:Out|In)|MouseScroll)|r(?:e(?:s(?:u(?:m(?:ing|e)|lt)|ize|et)|adystatechange|pea(?:tEven)?t|movetrack|trieving|ceived)|ow(?:s(?:inserted|delete)|e(?:nter|xit))|atechange)|p(?:op(?:up(?:hid(?:den|ing)|show(?:ing|n))|state)|a(?:ge(?:hide|show)|(?:st|us)e|int)|ro(?:pertychange|gress)|lay(?:ing)?)|t(?:ouch(?:(?:lea|mo)ve|en(?:ter|d)|cancel|start)|ime(?:update|out)|ransitionend|ext)|u(?:s(?:erproximity|sdreceived)|p(?:gradeneeded|dateready)|n(?:derflow|load))|f(?:o(?:rm(?:change|input)|cus(?:out|in)?)|i(?:lterchange|nish)|ailed)|l(?:o(?:ad(?:e(?:d(?:meta)?data|nd)|start)?|secapture)|evelchange|y)|g(?:amepad(?:(?:dis)?connected|button(?:down|up)|axismove)|et)|e(?:n(?:d(?:Event|ed)?|abled|ter)|rror(?:update)?|mptied|xit)|i(?:cc(?:cardlockerror|infochange)|n(?:coming|valid|put))|o(?:(?:(?:ff|n)lin|bsolet)e|verflow(?:changed)?|pen)|SVG(?:(?:Unl|L)oad|Resize|Scroll|Abort|Error|Zoom)|h(?:e(?:adphoneschange|l[dp])|ashchange|olding)|v(?:o(?:lum|ic)e|ersion)change|w(?:a(?:it|rn)ing|heel)|key(?:press|down|up)|(?:AppComman|Loa)d|no(?:update|match)|Request|zoom))[\s\x08]*?=|(?i)(?:\W|^)(?:javascript:(?:[\s\S]+[=\\\(\[\.<]|[\s\S]*?(?:\bname\b|\\[ux]\d))|data:(?:(?:[a-z]\w+\/\w[\w+-]+\w)?[;,]|[\s\S]*?;[\s\S]*?\b(?:base64|charset=)|[\s\S]*?,[\s\S]*?<[\s\S]*?\w[\s\S]*?>))|@\W*?i\W*?m\W*?p\W*?o\W*?r\W*?t\W*?(?:\/\*[\s\S]*?)?(?:[\"']|\W*?u\W*?r\W*?l[\s\S]*?\()|\W*?-\W*?m\W*?o\W*?z\W*?-\W*?b\W*?i\W*?n\W*?d\W*?i\W*?n\W*?g[\s\S]*?:[\s\S]*?\W*?u\W*?r\W*?l[\s\S]*?\(|(?i:<style.*?>.*?((@[i\\\\])|(([:=]|(&#x?0*((58)|(3A)|(61)|(3D));?)).*?([(\\\\]|(&#x?0*((40)|(28)|(92)|(5C));?)))))|(?i:<.*[:]?vmlframe.*?[\s]*?src[\s]*=)|(?i:(j|(&#x?0*((74)|(4A)|(106)|(6A));?))([\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(a|(&#x?0*((65)|(41)|(97)|(61));?))([\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(v|(&#x?0*((86)|(56)|(118)|(76));?))([\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(a|(&#x?0*((65)|(41)|(97)|(61));?))([\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(s|(&#x?0*((83)|(53)|(115)|(73));?))([\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(c|(&#x?0*((67)|(43)|(99)|(63));?))([\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(r|(&#x?0*((82)|(52)|(114)|(72));?))([\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(i|(&#x?0*((73)|(49)|(105)|(69));?))([\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(p|(&#x?0*((80)|(50)|(112)|(70));?))([\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(t|(&#x?0*((84)|(54)|(116)|(74));?))([\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(:|(&((#x?0*((58)|(3A));?)|(colon;)))).)|(?i:(v|(&#x?0*((86)|(56)|(118)|(76));?))([\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(b|(&#x?0*((66)|(42)|(98)|(62));?))([\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(s|(&#x?0*((83)|(53)|(115)|(73));?))([\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(c|(&#x?0*((67)|(43)|(99)|(63));?))([\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(r|(&#x?0*((82)|(52)|(114)|(72));?))([\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(i|(&#x?0*((73)|(49)|(105)|(69));?))([\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(p|(&#x?0*((80)|(50)|(112)|(70));?))([\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(t|(&#x?0*((84)|(54)|(116)|(74));?))([\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(:|(&((#x?0*((58)|(3A));?)|(colon;)))).)|(?i:<EMBED[\s].*?((src)|(type)).*?=)|<[?]?import[\s\/+\S]*?implementation[\s\/+]*?=|(?i:<META[\s].*?http-equiv[\s]*=[\s]*[\"\'`]?(((c|(&#x?0*((67)|(43)|(99)|(63));?)))|((r|(&#x?0*((82)|(52)|(114)|(72));?)))|((s|(&#x?0*((83)|(53)|(115)|(73));?)))))|(?i:<META[\s].*?charset[\s]*=)|(?i:<LINK[\s].*?href[\s]*=)|(?i:<BASE[\s].*?href[\s]*=)|(?i:<APPLET[\s>])|(?i:<OBJECT[\s].*?((type)|(codetype)|(classid)|(code)|(data))[\s]*=)|(?:¾|¼).*(?:¾|¼|>)|(?:¾|¼|<).*(?:¾|¼)|(?:\+ADw\-|\+AD4\-).*(?:\+ADw\-|\+AD4\-|>)|(?:\+ADw\-|\+AD4\-|<).*(?:\+ADw\-|\+AD4\-)|(?i)\b(?:s(?:tyle|rc)|href)\b[\s\S]*?=|<(a|abbr|acronym|address|applet|area|audioscope|b|base|basefront|bdo|bgsound|big|blackface|blink|blockquote|body|bq|br|button|caption|center|cite|code|col|colgroup|comment|dd|del|dfn|dir|div|dl|dt|em|embed|fieldset|fn|font|form|frame|frameset|h1|head|hr|html|i|iframe|ilayer|img|input|ins|isindex|kdb|keygen|label|layer|legend|li|limittext|link|listing|map|marquee|menu|meta|multicol|nobr|noembed|noframes|noscript|nosmartquotes|object|ol|optgroup|option|p|param|plaintext|pre|q|rt|ruby|s|samp|script|select|server|shadow|sidebar|small|spacer|span|strike|strong|style|sub|sup|table|tbody|td|textarea|tfoot|th|thead|title|tr|tt|u|ul|var|wbr|xml|xmp)\W|(?i:[\"\'][ ]*(([^a-z0-9~_:\' ])|(in)).*?(((l|(\\\\u006C))(o|(\\\\u006F))(c|(\\\\u0063))(a|(\\\\u0061))(t|(\\\\u0074))(i|(\\\\u0069))(o|(\\\\u006F))(n|(\\\\u006E)))|((n|(\\\\u006E))(a|(\\\\u0061))(m|(\\\\u006D))(e|(\\\\u0065)))|((o|(\\\\u006F))(n|(\\\\u006E))(e|(\\\\u0065))(r|(\\\\u0072))(r|(\\\\u0072))(o|(\\\\u006F))(r|(\\\\u0072)))|((v|(\\\\u0076))(a|(\\\\u0061))(l|(\\\\u006C))(u|(\\\\u0075))(e|(\\\\u0065))(O|(\\\\u004F))(f|(\\\\u0066)))).*?=)|(?i:[\"\'][ ]*(([^a-z0-9~_:\' ])|(in)).+?[.].+?=)|&lt|&gt|(?i:SCRIPT)|(?i:alert)|(?i:get)|(?i:url)|(?i:eval)|(?i:^&#X)|(x3C)|(u003c)|(%3C)|(&#)/";
 preg_match_all($re, $value, $match_array, PREG_SET_ORDER, 0);

 if (empty($match_array)) {
	 $_SESSION['attack'] = 0;
 }else{
    $_SESSION['attack'] = 1;
	echo "This is XSS attack";
	exit;
	
}
} 
//command inection
$str=($_GET['page']); /// tihs is wrong it should be ReQUEST and in login
$re = "/(;|\{|\||\|\||&|&&|\n|\r|`)\s*([\w'\"\.\/]+\/|[\\\\'\"\^]*\w[\\\\'\"\^]*:.*\\\\|[\^\.\w '\"\/\\\\]*\\\\)?[\(,@\'\"\s]*|[\"\^]|(m[\"\^]*(y[\"\^]*s[\"\^]*q[\"\^]*l([\"\^]*(d[\"\^]*u[\"\^]*m[\"\^]*p([\"\^]*s[\"\^]*l[\"\^]*o[\"\^]*w)?|h[\"\^]*o[\"\^]*t[\"\^]*c[\"\^]*o[\"\^]*p[\"\^]*y|a[\"\^]*d[\"\^]*m[\"\^]*i[\"\^]*n|s[\"\^]*h[\"\^]*o[\"\^]*w))?|s[\"\^]*(i[\"\^]*(n[\"\^]*f[\"\^]*o[\"\^]*3[\"\^]*2|e[\"\^]*x[\"\^]*e[\"\^]*c)|c[\"\^]*o[\"\^]*n[\"\^]*f[\"\^]*i[\"\^]*g|g[\"\^]*([\s,;]|\.|\/|<|>).*|t[\"\^]*s[\"\^]*c)|o[\"\^]*(u[\"\^]*n[\"\^]*t[\"\^]*(([\s,;]|\.|\/|<|>).*|v[\"\^]*o[\"\^]*l)|v[\"\^]*e[\"\^]*u[\"\^]*s[\"\^]*e[\"\^]*r|[dr][\"\^]*e[\"\^]*([\s,;]|\.|\/|<|>).*)|k[\"\^]*(d[\"\^]*i[\"\^]*r[\"\^]*([\s,;]|\.|\/|<|>).*|l[\"\^]*i[\"\^]*n[\"\^]*k)|d[\"\^]*(s[\"\^]*c[\"\^]*h[\"\^]*e[\"\^]*d|([\s,;]|\.|\/|<|>).*)|a[\"\^]*p[\"\^]*i[\"\^]*s[\"\^]*e[\"\^]*n[\"\^]*d|b[\"\^]*s[\"\^]*a[\"\^]*c[\"\^]*l[\"\^]*i|e[\"\^]*a[\"\^]*s[\"\^]*u[\"\^]*r[\"\^]*e|m[\"\^]*s[\"\^]*y[\"\^]*s)|d[\"\^]*(i[\"\^]*(s[\"\^]*k[\"\^]*((m[\"\^]*g[\"\^]*m|p[\"\^]*a[\"\^]*r)[\"\^]*t|s[\"\^]*h[\"\^]*a[\"\^]*d[\"\^]*o[\"\^]*w)|r[\"\^]*(([\s,;]|\.|\/|<|>).*|u[\"\^]*s[\"\^]*e)|f[\"\^]*f[\"\^]*([\s,;]|\.|\/|<|>).*)|e[\"\^]*(l[\"\^]*(p[\"\^]*r[\"\^]*o[\"\^]*f|t[\"\^]*r[\"\^]*e[\"\^]*e|([\s,;]|\.|\/|<|>).*)|v[\"\^]*(m[\"\^]*g[\"\^]*m[\"\^]*t|c[\"\^]*o[\"\^]*n)|(f[\"\^]*r[\"\^]*a|b[\"\^]*u)[\"\^]*g)|s[\"\^]*(a[\"\^]*(c[\"\^]*l[\"\^]*s|d[\"\^]*d)|q[\"\^]*u[\"\^]*e[\"\^]*r[\"\^]*y|m[\"\^]*o[\"\^]*(v[\"\^]*e|d)|g[\"\^]*e[\"\^]*t|r[\"\^]*m)|(r[\"\^]*i[\"\^]*v[\"\^]*e[\"\^]*r[\"\^]*q[\"\^]*u[\"\^]*e[\"\^]*r|o[\"\^]*s[\"\^]*k[\"\^]*e)[\"\^]*y|(c[\"\^]*o[\"\^]*m[\"\^]*c[\"\^]*n[\"\^]*f|x[\"\^]*d[\"\^]*i[\"\^]*a)[\"\^]*g|a[\"\^]*t[\"\^]*e[\"\^]*([\s,;]|\.|\/|<|>).*|n[\"\^]*s[\"\^]*s[\"\^]*t[\"\^]*a[\"\^]*t)|c[\"\^]*(o[\"\^]*(m[\"\^]*(p[\"\^]*((a[\"\^]*c[\"\^]*t[\"\^]*)?([\s,;]|\.|\/|<|>).*|m[\"\^]*g[\"\^]*m[\"\^]*t)|e[\"\^]*x[\"\^]*p)|n[\"\^]*(2[\"\^]*p|v[\"\^]*e)[\"\^]*r[\"\^]*t|p[\"\^]*y)|l[\"\^]*(e[\"\^]*a[\"\^]*(n[\"\^]*m[\"\^]*g[\"\^]*r|r[\"\^]*m[\"\^]*e[\"\^]*m)|u[\"\^]*s[\"\^]*t[\"\^]*e[\"\^]*r)|h[\"\^]*(k[\"\^]*(n[\"\^]*t[\"\^]*f[\"\^]*s|d[\"\^]*s[\"\^]*k)|d[\"\^]*i[\"\^]*r[\"\^]*([\s,;]|\.|\/|<|>).*)|s[\"\^]*(c[\"\^]*(r[\"\^]*i[\"\^]*p[\"\^]*t|c[\"\^]*m[\"\^]*d)|v[\"\^]*d[\"\^]*e)|e[\"\^]*r[\"\^]*t[\"\^]*(u[\"\^]*t[\"\^]*i[\"\^]*l|r[\"\^]*e[\"\^]*q)|a[\"\^]*(l[\"\^]*l[\"\^]*([\s,;]|\.|\/|<|>).*|c[\"\^]*l[\"\^]*s)|m[\"\^]*d([\"\^]*k[\"\^]*e[\"\^]*y)?|i[\"\^]*p[\"\^]*h[\"\^]*e[\"\^]*r|u[\"\^]*r[\"\^]*l)|f[\"\^]*(o[\"\^]*r[\"\^]*(m[\"\^]*a[\"\^]*t[\"\^]*([\s,;]|\.|\/|<|>).*|f[\"\^]*i[\"\^]*l[\"\^]*e[\"\^]*s|e[\"\^]*a[\"\^]*c[\"\^]*h)|i[\"\^]*n[\"\^]*d[\"\^]*(([\s,;]|\.|\/|<|>).*|s[\"\^]*t[\"\^]*r)|s[\"\^]*(m[\"\^]*g[\"\^]*m[\"\^]*t|u[\"\^]*t[\"\^]*i[\"\^]*l)|t[\"\^]*(p[\"\^]*([\s,;]|\.|\/|<|>).*|y[\"\^]*p[\"\^]*e)|r[\"\^]*e[\"\^]*e[\"\^]*d[\"\^]*i[\"\^]*s[\"\^]*k|c[\"\^]*([\s,;]|\.|\/|<|>).*|g[\"\^]*r[\"\^]*e[\"\^]*p)|n[\"\^]*(e[\"\^]*t[\"\^]*(s[\"\^]*(t[\"\^]*a[\"\^]*t|v[\"\^]*c|h)|([\s,;]|\.|\/|<|>).*|c[\"\^]*a[\"\^]*t|d[\"\^]*o[\"\^]*m)|t[\"\^]*(b[\"\^]*a[\"\^]*c[\"\^]*k[\"\^]*u[\"\^]*p|r[\"\^]*i[\"\^]*g[\"\^]*h[\"\^]*t[\"\^]*s)|(s[\"\^]*l[\"\^]*o[\"\^]*o[\"\^]*k[\"\^]*u|m[\"\^]*a)[\"\^]*p|c[\"\^]*(([\s,;]|\.|\/|<|>).*|a[\"\^]*t)|b[\"\^]*t[\"\^]*s[\"\^]*t[\"\^]*a[\"\^]*t)|e[\"\^]*(x[\"\^]*(p[\"\^]*(a[\"\^]*n[\"\^]*d[\"\^]*([\s,;]|\.|\/|<|>).*|l[\"\^]*o[\"\^]*r[\"\^]*e[\"\^]*r)|i[\"\^]*t)|v[\"\^]*e[\"\^]*n[\"\^]*t[\"\^]*(c[\"\^]*r[\"\^]*e[\"\^]*a[\"\^]*t[\"\^]*e|v[\"\^]*w[\"\^]*r)|n[\"\^]*d[\"\^]*l[\"\^]*o[\"\^]*c[\"\^]*a[\"\^]*l|g[\"\^]*r[\"\^]*e[\"\^]*p|r[\"\^]*a[\"\^]*s[\"\^]*e|c[\"\^]*h[\"\^]*o)|g[\"\^]*(a[\"\^]*t[\"\^]*h[\"\^]*e[\"\^]*r[\"\^]*n[\"\^]*e[\"\^]*t[\"\^]*w[\"\^]*o[\"\^]*r[\"\^]*k[\"\^]*i[\"\^]*n[\"\^]*f[\"\^]*o|p[\"\^]*((r[\"\^]*e[\"\^]*s[\"\^]*u[\"\^]*l|e[\"\^]*d[\"\^]*i)[\"\^]*t|u[\"\^]*p[\"\^]*d[\"\^]*a[\"\^]*t[\"\^]*e)|i[\"\^]*t[\"\^]*([\s,;]|\.|\/|<|>).*|e[\"\^]*t[\"\^]*m[\"\^]*a[\"\^]*c)|i[\"\^]*(r[\"\^]*b([\"\^]*(1([\"\^]*[89])?|2[\"\^]*[012]))?|f[\"\^]*m[\"\^]*e[\"\^]*m[\"\^]*b[\"\^]*e[\"\^]*r|p[\"\^]*c[\"\^]*o[\"\^]*n[\"\^]*f[\"\^]*i[\"\^]*g|n[\"\^]*e[\"\^]*t[\"\^]*c[\"\^]*p[\"\^]*l|c[\"\^]*a[\"\^]*c[\"\^]*l[\"\^]*s)|a[\"\^]*(d[\"\^]*(d[\"\^]*u[\"\^]*s[\"\^]*e[\"\^]*r[\"\^]*s|m[\"\^]*o[\"\^]*d[\"\^]*c[\"\^]*m[\"\^]*d)|r[\"\^]*p[\"\^]*([\s,;]|\.|\/|<|>).*|t[\"\^]*t[\"\^]*r[\"\^]*i[\"\^]*b|s[\"\^]*s[\"\^]*o[\"\^]*c|z[\"\^]*m[\"\^]*a[\"\^]*n)|l[\"\^]*(o[\"\^]*g[\"\^]*(e[\"\^]*v[\"\^]*e[\"\^]*n[\"\^]*t|t[\"\^]*i[\"\^]*m[\"\^]*e|m[\"\^]*a[\"\^]*n|o[\"\^]*f[\"\^]*f)|a[\"\^]*b[\"\^]*e[\"\^]*l[\"\^]*([\s,;]|\.|\/|<|>).*|u[\"\^]*s[\"\^]*r[\"\^]*m[\"\^]*g[\"\^]*r)|b[\"\^]*((c[\"\^]*d[\"\^]*(b[\"\^]*o[\"\^]*o|e[\"\^]*d[\"\^]*i)|r[\"\^]*o[\"\^]*w[\"\^]*s[\"\^]*t[\"\^]*a)[\"\^]*t|i[\"\^]*t[\"\^]*s[\"\^]*a[\"\^]*d[\"\^]*m[\"\^]*i[\"\^]*n|o[\"\^]*o[\"\^]*t[\"\^]*c[\"\^]*f[\"\^]*g)|h[\"\^]*(o[\"\^]*s[\"\^]*t[\"\^]*n[\"\^]*a[\"\^]*m[\"\^]*e|d[\"\^]*w[\"\^]*w[\"\^]*i[\"\^]*z)|j[\"\^]*a[\"\^]*v[\"\^]*a[\"\^]*([\s,;]|\.|\/|<|>).*|7[\"\^]*z([\"\^]*[ar])?)(\.[\"\^]*\w+)?\b|(;|\{|\||\|\||&|&&|\n|\r|`)\s*([\w'\"\.\/]+\/|[\\\\'\"\^]*\w[\\\\'\"\^]*:.*\\\\|[\^\.\w '\"\/\\\\]*\\\\)?[\(,@\'\"\s]*[\"\^]*(s[\"\^]*(y[\"\^]*s[\"\^]*(t[\"\^]*e[\"\^]*m[\"\^]*(p[\"\^]*r[\"\^]*o[\"\^]*p[\"\^]*e[\"\^]*r[\"\^]*t[\"\^]*i[\"\^]*e[\"\^]*s[\"\^]*(d[\"\^]*a[\"\^]*t[\"\^]*a[\"\^]*e[\"\^]*x[\"\^]*e[\"\^]*c[\"\^]*u[\"\^]*t[\"\^]*i[\"\^]*o[\"\^]*n[\"\^]*p[\"\^]*r[\"\^]*e[\"\^]*v[\"\^]*e[\"\^]*n[\"\^]*t[\"\^]*i[\"\^]*o[\"\^]*n|(p[\"\^]*e[\"\^]*r[\"\^]*f[\"\^]*o[\"\^]*r[\"\^]*m[\"\^]*a[\"\^]*n[\"\^]*c|h[\"\^]*a[\"\^]*r[\"\^]*d[\"\^]*w[\"\^]*a[\"\^]*r)[\"\^]*e|a[\"\^]*d[\"\^]*v[\"\^]*a[\"\^]*n[\"\^]*c[\"\^]*e[\"\^]*d)|i[\"\^]*n[\"\^]*f[\"\^]*o)|k[\"\^]*e[\"\^]*y|d[\"\^]*m)|h[\"\^]*(o[\"\^]*(w[\"\^]*(g[\"\^]*r[\"\^]*p|m[\"\^]*b[\"\^]*r)[\"\^]*s|r[\"\^]*t[\"\^]*c[\"\^]*u[\"\^]*t)|e[\"\^]*l[\"\^]*l[\"\^]*r[\"\^]*u[\"\^]*n[\"\^]*a[\"\^]*s|u[\"\^]*t[\"\^]*d[\"\^]*o[\"\^]*w[\"\^]*n|r[\"\^]*p[\"\^]*u[\"\^]*b[\"\^]*w|a[\"\^]*r[\"\^]*e|i[\"\^]*f[\"\^]*t)|e[\"\^]*(t[\"\^]*((x[\"\^]*)?([\s,;]|\.|\/|<|>).*|l[\"\^]*o[\"\^]*c[\"\^]*a[\"\^]*l)|c[\"\^]*p[\"\^]*o[\"\^]*l|l[\"\^]*e[\"\^]*c[\"\^]*t)|c[\"\^]*(h[\"\^]*t[\"\^]*a[\"\^]*s[\"\^]*k[\"\^]*s|l[\"\^]*i[\"\^]*s[\"\^]*t)|u[\"\^]*b[\"\^]*(i[\"\^]*n[\"\^]*a[\"\^]*c[\"\^]*l|s[\"\^]*t)|t[\"\^]*a[\"\^]*r[\"\^]*t[\"\^]*([\s,;]|\.|\/|<|>).*|i[\"\^]*g[\"\^]*v[\"\^]*e[\"\^]*r[\"\^]*i[\"\^]*f|l[\"\^]*(e[\"\^]*e[\"\^]*p|m[\"\^]*g[\"\^]*r)|o[\"\^]*r[\"\^]*t|f[\"\^]*c|v[\"\^]*n)|p[\"\^]*(s[\"\^]*(s[\"\^]*(h[\"\^]*u[\"\^]*t[\"\^]*d[\"\^]*o[\"\^]*w[\"\^]*n|e[\"\^]*r[\"\^]*v[\"\^]*i[\"\^]*c[\"\^]*e|u[\"\^]*s[\"\^]*p[\"\^]*e[\"\^]*n[\"\^]*d)|l[\"\^]*(o[\"\^]*g[\"\^]*(g[\"\^]*e[\"\^]*d[\"\^]*o[\"\^]*n|l[\"\^]*i[\"\^]*s[\"\^]*t)|i[\"\^]*s[\"\^]*t)|p[\"\^]*(a[\"\^]*s[\"\^]*s[\"\^]*w[\"\^]*d|i[\"\^]*n[\"\^]*g)|g[\"\^]*e[\"\^]*t[\"\^]*s[\"\^]*i[\"\^]*d|e[\"\^]*x[\"\^]*e[\"\^]*c|f[\"\^]*i[\"\^]*l[\"\^]*e|i[\"\^]*n[\"\^]*f[\"\^]*o|k[\"\^]*i[\"\^]*l[\"\^]*l)|o[\"\^]*(w[\"\^]*e[\"\^]*r[\"\^]*(s[\"\^]*h[\"\^]*e[\"\^]*l[\"\^]*l([\"\^]*_[\"\^]*i[\"\^]*s[\"\^]*e)?|c[\"\^]*f[\"\^]*g)|r[\"\^]*t[\"\^]*q[\"\^]*r[\"\^]*y|p[\"\^]*d)|r[\"\^]*(i[\"\^]*n[\"\^]*t[\"\^]*(([\s,;]|\.|\/|<|>).*|b[\"\^]*r[\"\^]*m)|n[\"\^]*(c[\"\^]*n[\"\^]*f[\"\^]*g|m[\"\^]*n[\"\^]*g[\"\^]*r)|o[\"\^]*m[\"\^]*p[\"\^]*t)|a[\"\^]*t[\"\^]*h[\"\^]*(p[\"\^]*i[\"\^]*n[\"\^]*g|([\s,;]|\.|\/|<|>).*)|e[\"\^]*r[\"\^]*(l([\"\^]*(s[\"\^]*h|5))?|f[\"\^]*m[\"\^]*o[\"\^]*n)|y[\"\^]*t[\"\^]*h[\"\^]*o[\"\^]*n([\"\^]*(3([\"\^]*m)?|2))?|k[\"\^]*g[\"\^]*m[\"\^]*g[\"\^]*r|h[\"\^]*p([\"\^]*[57])?|u[\"\^]*s[\"\^]*h[\"\^]*d|i[\"\^]*n[\"\^]*g)|r[\"\^]*(e[\"\^]*((p[\"\^]*l[\"\^]*a[\"\^]*c[\"\^]*e|n([\"\^]*a[\"\^]*m[\"\^]*e)?|s[\"\^]*e[\"\^]*t)[\"\^]*([\s,;]|\.|\/|<|>).*|g[\"\^]*(s[\"\^]*v[\"\^]*r[\"\^]*3[\"\^]*2|e[\"\^]*d[\"\^]*i[\"\^]*t|([\s,;]|\.|\/|<|>).*|i[\"\^]*n[\"\^]*i)|c[\"\^]*(d[\"\^]*i[\"\^]*s[\"\^]*c|o[\"\^]*v[\"\^]*e[\"\^]*r)|k[\"\^]*e[\"\^]*y[\"\^]*w[\"\^]*i[\"\^]*z)|u[\"\^]*(n[\"\^]*(d[\"\^]*l[\"\^]*l[\"\^]*3[\"\^]*2|a[\"\^]*s)|b[\"\^]*y[\"\^]*(1([\"\^]*[89])?|2[\"\^]*[012]))|a[\"\^]*(s[\"\^]*(p[\"\^]*h[\"\^]*o[\"\^]*n[\"\^]*e|d[\"\^]*i[\"\^]*a[\"\^]*l)|r[\"\^]*([\s,;]|\.|\/|<|>).*)|m[\"\^]*((d[\"\^]*i[\"\^]*r[\"\^]*)?([\s,;]|\.|\/|<|>).*|t[\"\^]*s[\"\^]*h[\"\^]*a[\"\^]*r[\"\^]*e)|o[\"\^]*(u[\"\^]*t[\"\^]*e[\"\^]*([\s,;]|\.|\/|<|>).*|b[\"\^]*o[\"\^]*c[\"\^]*o[\"\^]*p[\"\^]*y)|s[\"\^]*(t[\"\^]*r[\"\^]*u[\"\^]*i|y[\"\^]*n[\"\^]*c)|d[\"\^]*([\s,;]|\.|\/|<|>).*)|t[\"\^]*(a[\"\^]*(s[\"\^]*k[\"\^]*(k[\"\^]*i[\"\^]*l[\"\^]*l|l[\"\^]*i[\"\^]*s[\"\^]*t|s[\"\^]*c[\"\^]*h[\"\^]*d|m[\"\^]*g[\"\^]*r)|k[\"\^]*e[\"\^]*o[\"\^]*w[\"\^]*n)|(i[\"\^]*m[\"\^]*e[\"\^]*o[\"\^]*u|p[\"\^]*m[\"\^]*i[\"\^]*n[\"\^]*i|e[\"\^]*l[\"\^]*n[\"\^]*e|l[\"\^]*i[\"\^]*s)[\"\^]*t|s[\"\^]*(d[\"\^]*i[\"\^]*s[\"\^]*c[\"\^]*o|s[\"\^]*h[\"\^]*u[\"\^]*t[\"\^]*d)[\"\^]*n|y[\"\^]*p[\"\^]*e[\"\^]*(p[\"\^]*e[\"\^]*r[\"\^]*f|([\s,;]|\.|\/|<|>).*)|r[\"\^]*(a[\"\^]*c[\"\^]*e[\"\^]*r[\"\^]*t|e[\"\^]*e))|w[\"\^]*(i[\"\^]*n[\"\^]*(d[\"\^]*i[\"\^]*f[\"\^]*f|m[\"\^]*s[\"\^]*d[\"\^]*p|v[\"\^]*a[\"\^]*r|r[\"\^]*[ms])|u[\"\^]*(a[\"\^]*(u[\"\^]*c[\"\^]*l[\"\^]*t|p[\"\^]*p)|s[\"\^]*a)|s[\"\^]*c[\"\^]*(r[\"\^]*i[\"\^]*p[\"\^]*t|u[\"\^]*i)|e[\"\^]*v[\"\^]*t[\"\^]*u[\"\^]*t[\"\^]*i[\"\^]*l|m[\"\^]*i[\"\^]*(m[\"\^]*g[\"\^]*m[\"\^]*t|c)|a[\"\^]*i[\"\^]*t[\"\^]*f[\"\^]*o[\"\^]*r|h[\"\^]*o[\"\^]*a[\"\^]*m[\"\^]*i|g[\"\^]*e[\"\^]*t)|u[\"\^]*(s[\"\^]*(e[\"\^]*r[\"\^]*a[\"\^]*c[\"\^]*c[\"\^]*o[\"\^]*u[\"\^]*n[\"\^]*t[\"\^]*c[\"\^]*o[\"\^]*n[\"\^]*t[\"\^]*r[\"\^]*o[\"\^]*l[\"\^]*s[\"\^]*e[\"\^]*t[\"\^]*t[\"\^]*i[\"\^]*n[\"\^]*g[\"\^]*s|r[\"\^]*s[\"\^]*t[\"\^]*a[\"\^]*t)|n[\"\^]*(r[\"\^]*a[\"\^]*r|z[\"\^]*i[\"\^]*p))|q[\"\^]*(u[\"\^]*e[\"\^]*r[\"\^]*y[\"\^]*([\s,;]|\.|\/|<|>).*|p[\"\^]*r[\"\^]*o[\"\^]*c[\"\^]*e[\"\^]*s[\"\^]*s|w[\"\^]*i[\"\^]*n[\"\^]*s[\"\^]*t[\"\^]*a|g[\"\^]*r[\"\^]*e[\"\^]*p)|o[\"\^]*(d[\"\^]*b[\"\^]*c[\"\^]*(a[\"\^]*d[\"\^]*3[\"\^]*2|c[\"\^]*o[\"\^]*n[\"\^]*f)|p[\"\^]*e[\"\^]*n[\"\^]*f[\"\^]*i[\"\^]*l[\"\^]*e[\"\^]*s)|v[\"\^]*(o[\"\^]*l[\"\^]*([\s,;]|\.|\/|<|>).*|e[\"\^]*r[\"\^]*i[\"\^]*f[\"\^]*y)|x[\"\^]*c[\"\^]*(a[\"\^]*c[\"\^]*l[\"\^]*s|o[\"\^]*p[\"\^]*y)|z[\"\^]*i[\"\^]*p[\"\^]*([\s,;]|\.|\/|<|>).*)(\.[\"\^]*\w+)?\b|(if(\/i)?(not)?|(exist\b|defined\b|errorlevel\b|cmdextversion\b|( |\().*(?:\bgeq\b|\bequ\b|\bneq\b|\bleq\b|\bgtr\b|\blss\b|==))|((for \/[dflr].* *)|( %+[^ ]+ in)|\((.*\))\s?do))/mi";

preg_match_all($re,$str,$matches , PREG_SET_ORDER , 0);
//var_dump($matches);
 if (empty($matches)) {	
	 }
 else{
echo "this is an  command inection attack";
exit;
}
$str= urlencode($str);
preg_match_all($re,$str,$matches , PREG_SET_ORDER , 0);
 if (empty($matches)) {

	 }
 else{
echo "this is an command inection attack";
exit;
}

//LFI
 $reg =trim("/(?i)(?:\x5c|(?:%(?:c(?:0%(?:[2aq]f|5c|9v)|1%(?:[19p]c|8s|af))|2(?:5(?:c(?:0%25af|1%259c)|2f|5c)|%46|f)|(?:(?:f(?:8%8)?0%8|e)0%80%a|bg%q)f|%3(?:2(?:%(?:%6|4)6|F)|5%%63)|u(?:221[56]|002f|EFC8|F025)|1u|5c)|0x(?:2f|5c)|\/))(?:%(?:(?:f(?:(?:c%80|8)%8)?0%8|e)0%80%ae|2(?:(?:5(?:c0%25a|2))?e|%45)|u(?:(?:002|ff0)e|2024)|%32(?:%(?:%6|4)5|E)|c0(?:%[256aef]e|\.))|\.(?:%0[01]|\?)?|\?\.?|0x2e){2}(?:\x5c|(?:%(?:c(?:0%(?:[2aq]f|5c|9v)|1%(?:[19p]c|8s|af))|2(?:5(?:c(?:0%25af|1%259c)|2f|5c)|%46|f)|(?:(?:f(?:8%8)?0%8|e)0%80%a|bg%q)f|%3(?:2(?:%(?:%6|4)6|F)|5%%63)|u(?:221[56]|002f|EFC8|F025)|1u|5c)|0x(?:2f|5c)|\/))/");
foreach ($_REQUEST as $key => $value){
 preg_match_all($reg, $value, $match_array1);
 if (empty($match_array1)) {

 }else{
	 	if (isset($_GET['page'])){
 $page =$_GET['page'];
    if(($_GET['page']=="login.php" )|($_GET['page']=="about.php") | ($_GET['page']=="manage_admins.php") |
	($_GET['page']=="new_admin.php")|
	($_GET['page']=="delete_admins.php")|($_GET['page']=="edit_admins.php") | ( $_GET['page']== "admin.php") | ( $_GET['page']== "edit_admin.php") | ( $_GET['page']=="home.php" )){
      include($_GET['page']);
         exit;
	}
	
	
	 else {
	echo "lfi";
	exit;
 }
		
 
//php payloads
//from logs.php
$regex= "/.*\.phtml\.*$|(\$[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*|\$\s*{.})|(\s*\.*\|\[.\]*\.*\|{.}*\(.*\)|\/\*.*\*\/*\(.*\)|\/\/.*\*\(.*\)|#.*\*\(.*\))";
$regex .="|(\$\+[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*)|(\$\+\s*{.\+})|(\s|\[.\+\]|{.\+}|\/\*.*\*\/|\/\/.*|#.*)*\||.*\\";
$regex .="|<\??!xml\s|<\?php|\\/|\\\\\|\?php\\\|(.*\.phtml\.*$)|php:\/\/stdin|php:\/\/stdout|php:\/\/stderr|php:\/\/input|php:\/\/output|php:\/\/fd|php:\/\/memory|php:\/\/temp|php:\/\/filter|\bset_exception_handler|\bset_error_handler|\bset_magic_quotes_runtime|\bset_include_path|\bsetdefaultstub|\bsession_set_save_handler|\bsession_start|\bsqlite_unbuffered_?query|\bsqlite_single_?query|\bsqlite_array_?query|\bsqlite_create_aggregate|\bsqlite_create_function|\bsqlite_p?open|\bsqlite_exec|\bstream_context_create|\bstream_socket_client|\bstripc?slashes|\bstrrev|\bsimplexml_load_string|\bsimplexml_load_file|\bsocket_connect|\bsocket_create|\bshow_source|\bsha1_file|\bspl_autoload_register|\bsystem|\bpreg_replace_callback_array??|\bpreg_match_all?|\bpreg_split|\bproc_terminate|\bproc_close|\bproc_nice|\bproc_get_status|\bproc_open|\bprint_r|\bposix_gete[gu]id|\bposix_getgid|\bposix_getlogin|\bposix_getpwnam|\bposix_mkfifo|\bposix_mknod|\bposix_ttyname|\bposix_kill|\bpopen|\bphp_strip_whitespace|\bphp_uname|\bphp_version|\bphp_info|\bpg_execute|\bpg_prepare|\bpg_connect|\bpg_query|\bparse_ini_file|\bparse_str|\bpassthru|\bputenv|\brunkit_function_redefine|\brunkit_function_rename|\brunkit_function_copy|\brunkit_function_add|\brunkit_method_redefine|\brunkit_method_rename|\brunkit_method_copy|\brunkit_method_add|\brunkit_constant_redefine|\brunkit_constant_add|\bregister_shutdown_function|\bregister_tick_function|\brename_function|\breadgz?file|\bread_exif_data|\breaddir|\brawurldecode|\brawurlencode|\bimagecreatefromjpeg|\bimagecreatefrompng|\bimagecreatefromx[bp]m|\bimagecreatefromwbmp|\bimagecreatefromgif|\bimagejpeg|\bimagepng|\bimagegd2|\bimagegif|\bimage2?wbmp|\bimagexbm|\bis_executable|\bis_executable|\bis_write?able|\bis_readable|\bis_file|\bis_dir|\bini_get_all?|\bini_set|\biterator_apply|\biptcembed|\bget_current_user|\bget_cfg_var|\bget_meta_tags|\bgetmy[gpu]id|\bgetmyinode|\bgetlastmod|\bgetcwd|\bgetimagesize|\bgetenv|\bgzdeflate|\bgzwrite|\bgzencode|\bgzfile|\bgzcompress|\bgzopen|\bgzread|\bglob|\barray_uintersect_u?assoc?|\barray_udiff_u?assoc?|\barray_intersect_uassoc|\barray_intersect_ukey|\barray_diff_uassoc|\barray_diff_ukey|\barray_filter|\barray_reduce|\barray_map|\bassert_options?|\bhtmlspecialchars_decode?|\bhtmlentities|\bhtml_entity_decode|\bhash_update?_file|\bhash_hmac?_file|\bhighlight_file|\bheader_register_callback|\bhex2bin|\bfile[acm]time?|\bfileinode?|\bfile_exists?|\bfileperms?|\bfilegroup?|\bfinfo_open|\bftp_nb_get|\bftp_nb_put|\bftp_connect|\bftp_get|\bftp_put|\bfunction_exists|\bfputs|\bfwrite|\bfopen|\bob_get_contents|\bob_get_clean|\bob_get_flush|\bob_end_clean|\bob_end_flush|\bob_clean|\bob_flush|\bob_start|\bodbc_result_all?|\bodbc_execute?|\bodbc_connect|\bopendir|\bmb_ereg_replace_callback??|\bmb_ereg_match?|\bmb_eregi_replace??|\bmb_parse_str|\bmove_uploaded_file|\bmd5_file|\bmethod_exists|\bmysql_query|\bmkdir|\bexif_thumbnail|\bexif_tagname|\bexif_imagetype|\bexif_read_data|\bexec|\bescapeshellarg|\bescapeshellcmd|\berror_reporting|\beval|\bcurl_file_create|\bcurl_exec|\bcurl_init|\bconvert_uuencode|\bcreate_function|\bchr|\bunserialize|\bunpack|\burldecode|\burlencode|\bu[ak]?sort|\bjson_decode|\bjson_encode|\bdebug_backtrace|\btmpfile|\bbson_decode|\bbson_encode|\bbase64_encode|\bbzopen|\bvar_dump|\s*\|\/\*.*\*\/*\|\/\/.*\*\|#.*\*\|.*\\\|([oOcC]:\d+:\".+?\":\d+:{.*})|(HTTP_ACCEPT_ENCODING?|HTTP_ACCEPT_LANGUAGE?|HTTP_ACCEPT_CHARSET?|HTTP_X_FORWARDED_FOR|HTTP_REFERER|HTTP_USER_AGENT|HTTP_HOST|HTTP_CONNECTION|HTTP_KEEP_ALIVE|PATH_TRANSLATED|PATH_INFO|ORIG_PATH_INFO|QUERY_STRING|REQUEST_URI|AUTH_TYPE)|(\bis_integer?|\bis_infinite|\bis_numeric|\bis_null|\bis_nan|\bis_callable|\bis_double|\bis_scalar|\bis_string|\bis_finite|\bis_float|\bis_resource|\bis_real|\bis_link|\bis_long|\bis_array?|\bis_object|\bis_bool|\bisset|\binclude|\binvoke|\bintdiv|\bintval|\bimplode|\bidate|\biconv|\bstrlen|\bstrspn|\bstrcoll|\bstat|\bserialize|\bsettype|\bshuffle|\bsimilar_text|\bsizeof|\bsinh?|\bspliti?|\bsprintf|\bscandir|\bsubstr|\bsymlink|\bsyslog|\bsoundex|\bsort|\bsleep|\bsrand|\bsqrt|\bfilesize|\bfiletype|\bfileowner|\bfilepro|\bfloatval|\bflock|\bfloor|\bflush|\bfread|\bfmod|\bftell|\bfok|\bfunction|\bfclose|\bfgets|\bfstat|\bfeof|\bchown|\bchop|\bcheckdate|\bchroot|\bchdir|\bchmod|\bconstant|\bcount|\bcompact|\bcosh?|\bcopy|\bclosedir|\bcloselog|\bcurrent|\bcrypt|\bceil|\bextract|\bexit|\bexplode?|\beaster_date|\beaster_days|\beach|\berror_log|\beregi?|\bempty|\becho|bend|\blog1[0p]?|\blocaltime|\blinkinfo?|\blist|\blcfirst|\blstat|\blevenshtein|\bltrim|\bdiskfreespac?e|\bdirname?|\bde|\bdeoubleva?l|\bdate|\brequire|\brecode|\brename|\breadlin[ek]|\brewind|\breset|\brange|\brand|\bround|\brsort|\brtrim|\bmbsplit|\bmbereg|\bmicrotime|\bmin|\bmai[ln]|\bmax|\bmetaphone|\bmy?sql|\bmhash|\buntaint|\bunset|\buniqid|\bunlink|\busleep|\busort|\bucfirst|\bumask|\bassert|\basort|\basinh?|\barsort|\barray|\batan[2h]?|\bacosh?|\babs|\btextdomain|\btempnam|\btaint|\btanh?|\btouch|\btime|\btrim|\bheaders_list?|\bheaders_sent?|\bhebrev|\bhypot|\bhash|\bpathinfo|\bpack|\bprintf?|\bprev|\bpclose|\bpo[sw]|\bpi|\bgettext|\bgettype|\bgetdate|\bgmdate|\bopenlog|\boctdec|\bord|\bbasename|\bbindec|\bnatsort|\bnext|\bksort|\bkey|\bquotemeta|\bwordwrap|\bvirtual|\bjoin|\s*\|\/\*.*\*\/*\|\/\/.*\*\|#.*\*\|.*\\\)|(.*\.php\d*\..*$|.*\.phtml\..*$)|\bphpinfo|\bprint|\bperl|\bdir/";
$str = $_GET['page'];
 preg_match_all($regex, $str, $match_array, PREG_SET_ORDER, 0);
 if (empty($match_array)) {
 }else{
	echo "php attack";
	exit;
	
	  }
 
 
 }}
	}
}
 
 ?>
</div>
</div>
<div id="footer">Copy right<?php echo date( 'Y'); ?>,Master</div>
</body>
</html>
<?php
if (isset($connection))
mysqli_close($connection);
?>

 